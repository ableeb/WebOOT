<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" xmlns:tal="http://xml.zope.org/namespaces/tal">
<head>
  <title>Results</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
  <script type="text/javascript" src="${request.static_url('weboot:static/js/jquery-1.6.2.js')}"></script>
  <script type="text/javascript" src="${request.static_url('weboot:static/js/jquery-ui-1.8.15.custom.min.js')}"></script>
  <script type="text/javascript">
  function update_plot() {
    var p = $("#plot");
    query_str = $.map(p.data("properties"), 
        function (val, key) { return key + "=" + val; })
        .join("&");
    
    $("#plot").attr("src", p.data("orig-src") + "?" + query_str);
  }
  function add_toggleable(what) {
    var props = $("#plot").data("properties");
    $("#" + what)
        .button().disableSelection()
        .click(function (){
            if (this.checked) props[what] = true;
            else delete props[what];
            update_plot();
        });
  }
  
  $(function () {
    $("#plot").data("properties", {});
    $("#plot").data("orig-src", $("#plot").attr("src"));
    
    $(".breadcrumb").click(function() {
        var clicked = this;
        var clicked_idx = 0;
        var crumbs = $(".breadcrumb");
        crumbs.each(function (i) {
            if (this != clicked) return;
            clicked_idx = i+1;
            return false;
        });
        
        url = crumbs.slice(0, clicked_idx).map(function() {return $(this).text();}).get().join("/");
        dest = $("#base_url").attr("href") + url;
        window.location = dest;
        //alert();
                
        
        query = crumbs.map(function () { 
                return this == clicked ? "*" : $(this).text(); 
            }).get().join("/");
        //alert(query);
    })
    $(".button").button();
    
    add_toggleable("logx");
    add_toggleable("logy");
    add_toggleable("logz");     
    add_toggleable("hist");
    add_toggleable("e0x0");
  })
  </script>
  <link rel="stylesheet" href="${request.static_url('weboot:static/pylons.css')}" type="text/css" media="screen" charset="utf-8" />
  <link rel="stylesheet" href="${request.static_url('weboot:static/smoothness/jquery-ui-1.8.15.custom.css')}" type="text/css" media="screen" charset="utf-8" />
  <style type="text/css">
    .breadcrumb {
        margin: 0 0.25em 0 0.25em;
        color: #eee;
        padding: 0.2em;
        background: #888;
        border: 1px solid #666;
    }
    #sidebar {
        padding: 0.4em;
        margin: 2em;
        float:right;
        width:300px;
        background:#99c;
    }
    #buttons a,label {
        -moz-user-select: none;
        -khtml-user-select: none;
        -webkit-user-select: none;
        user-select: none;
        margin: 0.4em;
    }
  </style>
</head>
<body>
  <div id="wrap">
    <div id="middle">
      <div class="middle align-center">
        <p class="app-welcome">
          <a href="${request.resource_url(None)}" id="base_url"></a>${path}
        </p>
      </div>
    </div>
    <div id="sidebar">
      <div id="buttons">
        <input type="checkbox" id="logx" /><label for="logx">log X</label>
        <input type="checkbox" id="logy" /><label for="logy">log Y</label>
        <input type="checkbox" id="logz" /><label for="logz">log Z</label>
        <input type="checkbox" id="hist" /><label for="hist">Hist</label>
        <input type="checkbox" id="e0x0" /><label for="e0x0">Y Error Bars</label>
        <a class="button" href="!project/x">Project X</a>
        <a class="button" href="!project/y">Project Y</a>
        <a class="button" href="!project/z">Project Z</a>


      </div>
    </div>
    <div id="bottom">
      <div class="bottom">
        ${content}
      </div>
    </div>
  </div>
  <div id="footer">
    <div class="footer">&copy;</div>
  </div>
</body>
</html>
